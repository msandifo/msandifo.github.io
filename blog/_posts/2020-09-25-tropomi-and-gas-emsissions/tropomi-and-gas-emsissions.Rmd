---
title: "Tropomi and fugitive methane emissions - recent insights"
description: |
    The Tropomi sensor on Sentinel 5p offers new insights into fugitive meatane emissions in US gas producing basins. Here I explore some of the implications of recent findings, integrating the observations with gas production data.
author:
  - name: Mike Sandiford
date: 09-25-2020
output:
  distill::distill_article:
    self_contained: false
bibliography: Bibliography.bib
csl: agu.csl
---

```{r setup, include=FALSE, echo=FALSE, message=F, cache=F}
knitr::opts_chunk$set(echo = FALSE,  message=FALSE)


blog.dir<- getwd()
lng.dir<-"/Volumes/data/Dropbox/msandifo/documents/programming/r/2020/LNG/"
setwd(lng.dir)
library(reproscir)
library(tidyverse)
library(ggplot2)
library(hrbrthemes)
library(magrittr)
library(readxl)
library(stringr)
library(lubridate)
library(scales)

#extrafont::loadfonts()
update=F
source('r/funcs.R')
source('r/units.R')
source('r/data.R')
source('r/bakken_data.R')
source('r/permian_flaring_rystad.R')

plots=TRUE

setwd(blog.dir)
```

![Bakken by satellite](https://geology.com/articles/oil-fields-from-space/bakken-shale.jpg) 

# Tropomi

CH4 release from large oil and gas fields can now be monitored from space using the TROPOspheric Monitoring Instrument (TROPOMI) onboard the Sentinel-5 Precursor satellite.

A recent study by    @schneising2020 concluded 
that 

> the average [methane] emissions for the time period 2018/2019 from the five most productive basins in the United States, the Permian, Appalachia, Eagle Ford, Bakken, and Anadarko are estimated to be 3.16±1.13 Mt yr^−1^, 2.36 ± 0.88 Mt yr^−1^ , 1.52 ± 0.68 Mt yr^−1^ , 0.89 ± 0.56 Mt yr^−1^, and 2.81 ± 0.77 Mt yr^−1^ , respectively. This corresponds to CH4 leakage rates relative to the associated production between 1.2% and 1.6% for the first four production regions, which are consistent with bottom-up estimates and likely fall below the break-even leakage rate for immediate climate benefit.
 
The @schneising2020 study is  important study as it compliments others which have attempted to address the emissions associated with shale gas production from "bottom up" methods  [@howarth; @howarth2014;@helmig2016;@howarth2019], with  widely varying estimates.

It is important to note that  @schneising2020 emission rates are referenced with respect to the total energy production including both gas and oil. As discussed further below, the largest methane emissions are likley ot be in basins where oil production drives investment, which are known to  flare a legr proportion of the gas production. The oil-rich basins, which include the Bakken and the Permian, the percentage of vented methane referenced against total gas production is necessarily very much higher than referenced against bulk energy as in @schneising2020. This is is significant, because it is way gas is used that is central to the purported "gas as a transition fuel" debate [e.g., @howarth2014]

In this study I look at the emissions rates in terms of total gas production, by comparing them with production data from publicly available sources. So doing helps clarify the venting to flaring ratio - a critical poorly defined parameter relevant to emission trajectories.   

The primary focus here is on the Bakken and the Permian "basins". I begin with some scene setting relating to US shale gas production, and changes in atmospheric methane concentrations.


## US shale gas  
The advent of shale gas production in the mid 2000's has dramatically increased US gas production from ~2000 Bcf per month to a peak of ~3500 Bcf per month in late 2019, prior to the COVID-19 downturn (Fig. \@ref(fig:fig-dom)).

```{r fig-dom, echo=FALSE, fig.cap="US gas production, sourced from EIA", height=10, cache=TRUE}
cowplot::plot_grid(  plot_data("eia.us.ng.withdrawals" ) + 
  scale_y_continuous(sec.axis = sec_axis(~.*bcf2mt*12, name="Mt CH4 per year") )+
    labs(y="Bcf per month", title=NULL) + 
    geom_vline(xintercept=c(2006,2017), size=.3, linetype=2),
 
reproscir::plot_data("cape.grim.ch4" ) + scale_y_continuous(sec.axis = sec_axis(~.*1, name=" ") ) + 
  labs(title=NULL)+
  geom_vline(xintercept=lubridate::ymd(c("2006-01-01","2017-01-01")), size=.3, linetype=2), 
ncol=1, labels=c("a)","b)")
)
```


Now averaging around 500 million tones (CH~4~) (Fig. \@ref(fig:fig-dry-gas)) per year, shale gas production accounts for all the growth in production since 2006, and more .  

```{r fig-dry-gas, echo=FALSE, fig.cap="US shale gas production by basin, EIA",  cache=TRUE}
reproscir::plot_data("eia.drygas")  +
  scale_y_continuous(sec.axis = sec_axis(~.*bcf2mt*365, name="million tonnes CH4 per year") )+ geom_vline(xintercept=lubridate::ymd(c("2006-01-01","2017-01-01")), size=.3, linetype=2)+
  labs(title=NULL)
```

_to add_ - comments about correlation in US gas and CH~4~ growth rates

```{r tab-ndg, echo=FALSE}
#kableExtra::kable(ndg.y[c(2,3,1,4),], digits=2)
kableExtra::kable(ndg.yc  )

```
A feature in many of the shale gas producing regions is the large extent of gas flaring.
In the Permian Basin, [Rystad](https://www.rystadenergy.com/newsevents/news/press-releases/a-downturn-silver-lining-permian-gas-flaring-has-decreased-and-is-expected-to-fall-further-in-2020/) estimates an average of  over `r round(pfr.y$flare.mmcf[pfr.y$year==2019]/10)*10` Mmcf per day flaring across 2019  (Fig. \@ref(fig:fig-ry)). 
For example in the Bakken, in the Williston Basin, gas flaring is clearly  [visible by satellite](https://en.wikipedia.org/wiki/Bakken_Formation). 
<!-- (Fig. \@ref(fig:fig-sat)). -->

```{r fig-ry, echo=FALSE, fig.cap="Estimates of gas flaring in the Permian Basin by quarter (black) and Bakken by month (red). Permian flaring data sourced from [https://www.rystadenergy.com/newsevents/news/press-releases/a-downturn-silver-lining-permian-gas-flaring-has-decreased-and-is-expected-to-fall-further-in-2020/](https://www.rystadenergy.com/newsevents/news/press-releases/a-downturn-silver-lining-permian-gas-flaring-has-decreased-and-is-expected-to-fall-further-in-2020/). Bakken data from North Dakota Industrial Commision, https://www.dmr.nd.gov/oilgas/stats/Gas1990ToPresent.xls",  cache=TRUE}

ggplot(pfr, aes(date, flare.mmcf))+
  geom_line(size=.2)+
#  geom_point(shape=5, size=2.)+
     geom_line(data=ndg.s, col="red3", linetype=1, size=.2)+

#  geom_point(size=.2)+
   geom_hline(yintercept=ndg.s.y$flare.mmcf[ndg.s.y$year>2017], linetype=2, size=.15, col="red3")+
  geom_hline(yintercept=pfr.y$flare.mmcf[pfr.y$year>2017], linetype=2, size=.15)+
    scale_y_continuous(sec.axis = sec_axis(~.* mmcf2mt * 365, name="million tonnes per year") )+
  geom_text(data=pfr.y %>% subset(year>2017),
            aes(x= ymd("2013-06-01"),label= paste("Permian :",round(flare.mmcf/10)*10, "MMcf/day,\n", round(flare.mmcf* mmcf2mt * 365, 1), "mill. tonnes,",year)),
            vjust=-.3, size=2.)+
    geom_text(data=ndg.s.y %>% subset(year>2017),
            aes(x= ymd("2012-06-01"),label= paste("Bakken :", round(flare.mmcf/10)*10, "MMcf/day,\n", round( flare.mmcf* mmcf2mt * 365, 1), "mill. tonnes,",year)),
            vjust=1.2, size=2., col="red2")+
    labs(y="million cubic feet per day", x=NULL,
       title= "Permian/Bakken flaring and venting",
       caption=NULL)#"source: https://www.rystadenergy.com/newsevents/news/press-releases/a-downturn-silver-lining-permian-gas-flaring-has-decreased-and-is-expected-to-fall-further-in-2020/ ")


#knitr::include_graphics("https://www.rystadenergy.com/globalassets/news--events/press-releases/borr-drilling/permian-flaring-pr.jpg")
```


<!-- ```{r fig-sat, echo=FALSE, fig.cap="Baken flaring  source from [https://geology.com/articles/oil-fields-from-space/#bakken-formation](https://geology.com/articles/oil-fields-from-space/#bakken-formation)",  cache=TRUE} -->
<!-- knitr::include_graphics("https://geology.com/articles/oil-fields-from-space/bakken-shale.jpg") -->
<!-- ``` -->

<!-- ![Bakken by satellite](https://geology.com/articles/oil-fields-from-space/bakken-shale.jpg) -->




## the Bakken

Like many of the U.S. shale gas plays, oil is the principal commodity driving investment in the Bakken. In 2019, Bakken production accounted to ~ `r paste0(mean(bakken.oil$p[bakken.oil$year %in%  2019]) %>% round(1), "%")` of all U.S. tight oil, whereas it accounted for only `r paste0(mean(bakken.gas$p[bakken.gas$year %in%  2019])%>% round(1), "%")` of U.S shale gas production (cf. Figs \@ref(fig:fig-dry-gas) & \@ref(fig:fig-tight-oil)). 

```{r fig-tight-oil, echo=FALSE, fig.cap="US tight oil production by formation, EIA.  The Permian includes the Wolfcamp, Spraberry, and Bone Spring Formations",  cache=TRUE}
reproscir::plot_data("eia.tightoil")+
  scale_y_continuous(sec.axis = sec_axis(~.*0.1364*365, name="million tonnes oil per year") )+
  labs(title="EIA tight oil production by formation")
 
```


The Bakken dominates hydocarbon production in North Dakota, which is [third largest state oil producer](https://www.eia.gov/state/rankings/#/series/46).

With gas essentially a by-product,  a considerable flaring and venting at the well head.


Monthly production, sales and flaring in [North Dakota](https://www.dmr.nd.gov/oilgas/stats/Gas1990ToPresent.xls) is reported by `r reproscir::read_data("north.dakota.gas", data = F, ver=F)$agency`. Typically about 4-5% of production remains unnaccounted for in terms of sales and flaring.
 
 
```{r fig-bakken-1, echo=FALSE, fig.cap="Bakken gas production, NDGG. EIA bakken production in black line",  cache=TRUE}
reproscir::read_data("eia.drygas")$data %>% subset(date > lubridate::ymd("2005/01/01"))%>% 
  subset(field=="Bakken") %>%
  ggplot(data=., aes(x=date,y=value))+
  geom_area(data= bdg %>% subset(date > lubridate::ymd("2005/01/01") ),
            aes(x=date,y=value/1e6/(365/12), fill=type), position = "stack",  
            #converts Mcf per month to BCF per day
            colour = "white",
            size = .15)+
  scale_fill_manual(values = c("grey30", "firebrick1", "green4")) +
  geom_line()+
  scale_y_continuous(sec.axis = sec_axis(~.*1e3* mmcf2mt * 365, name="million tonnes per year") )+
  theme(
    legend.position = c(.12, .8),
    legend.direction = "vertical",
    legend.background = element_rect(fill = mmt::add.alpha("white", .6), size =
                                       0) ,
    legend.title =  element_blank()
  ) +
  labs(
    title = paste(ndg.i$legend,": Bakken"),
    caption = paste0(ndg.i$link, "\n* assumed vented"),
    #    subtitle="annualised production",
    y = "billion cubic feet per day", #reproscir::read_data("eia.drygas")$type$units,
    x = NULL
  ) +
  coord_cartesian(expand = c(0, 0))
```
```{r fig-bakken-1a, echo=FALSE, fig.cap="Bakken gas production,   EIA",  cache=FALSE}
  
  dg.eia<-read_data("eia.north.dakota.gas")$data%>% arrange(field); 
    ggplot(dg.eia %>% subset(field %in% c("marketed.production","vented.flared") & date>lubridate::ymd("2006-01-01")),aes((date),value/1000/(365/12),fill=field)) +
    geom_area(position=position_stack(reverse = TRUE),colour="grey80", size=.13)+
    scale_fill_manual(values= c("black","grey80","red3","orange2"))+
  labs(x=NULL,y="billion cubic feet per day")+
    theme(legend.position=c(.15,.85))+scale_x_date(expand=c(.0,.0))+
    geom_line(data=dg.eia%>%subset(field%in%c("gross.withdrawals")&date>lubridate::ymd("2006-01-01")),fill="white",show.legend=F)+
     geom_line(data=dg.eia%>%subset(field%in%c("shale.gas")&date>lubridate::ymd("2006-01-01")),fill="white",col="red3",show.legend = F)+
    scale_y_continuous(expand=c(0.0,0),sec.axis = sec_axis(~.*1e3* mmcf2mt * 365, name="million tonnes per year") )+

  labs(caption=get_agency("eia.north.dakota.gas"), title=get_title("eia.north.dakota.gas"))

```
  
```{r fig-bakken-2, echo=FALSE, fig.cap="Bakken",  cache=FALSE}
ggplot(bdg %>% subset(date > lubridate::ymd("2005/01/01")),
       aes(date, value , fill = type)) +
  geom_area(position = position_fill(reverse = T),
            colour = "white",
            size = .15) +
  scale_fill_manual(values = c("grey30", "firebrick1", "green4")) +
  scale_y_continuous(label =  scales::percent_format(accuracy = 1)) +

  theme(
    legend.position = c(.86, .9),
    legend.direction = "vertical",
    legend.background = element_rect(fill = mmt::add.alpha("white", .7), size =
                                       0) ,
    legend.title =  element_blank()
  ) +
  labs(
    title = paste(ndg.i$legend,": Bakken"),
    caption = paste0(ndg.i$link), #, "\n* assumed vented"),
 #   subtitle = "percentage production",
    y = NULL,
    x = NULL
  ) +
  coord_cartesian(ylim = c(0, .5),  expand = c(0, 0)) +
  geom_hline(
    yintercept = 1 - c(.8, .7, .9, .6),
    colour = "white",
    size = .2,
    linetype = 2
  )
```


```{r fig-bakken-3, echo=FALSE, fig.cap="Bakken",  cache=TRUE}
fac<-     (bcf2mt*365)
ggplot(
  ndg.a %>% subset(date > lubridate::ymd("2009/01/01") &
                     type != "sold"),
  aes(date, value/1e6/(365/12) , fill = type)
) +
  geom_area(position = position_stack(reverse = T),
            colour = "white",
            size = .2) +
  scale_fill_manual(values = c("grey30", "firebrick1", "green4")) +
  #scale_y_continuous(label =  scales::percent_format()) +
    scale_y_continuous(sec.axis = sec_axis(~.*bcf2mt * 365, name="million tonnes per year") )+
 theme(
    legend.position = c(.15, .85),
    legend.direction = "vertical",
    legend.background = element_rect(fill = mmt::add.alpha("white", .6), size =
                                       0) ,
    legend.title =  element_blank()
  ) +
  labs(
    title = "North Dakota unsold production",
    caption = paste0(ndg.i$link, "\n* assumed vented"),
    #subtitle = "annualised production",
     y = "billion cubic feet per day",
    x = NULL
  ) +
  coord_cartesian(expand = c(0, 0))+
  annotate("line", x=ymd(c("2018-01-01", "2020-01-01")), y=c( 0.89, .89)/fac, col="white", size=1.2)+
annotate("line", x=ymd(c("2018-01-01", "2020-01-01")), y=c( 0.89-.56, .89-.56)/fac, col="white", size=.5, linetype=2)+
  annotate("line", x=ymd(c("2018-01-01", "2020-01-01")), y=c( 0.89+.56, .89+.56)/fac, col="white", size=.5, linetype=2)+
annotate("text", x=ymd(c( "2017-11-01")), y=c(   .89)/fac, label="Schneising\net al., 2020", hjust=1, col="white", size=3)

```

## CO2-e emissions 

```{r fig-bakken-100, echo=FALSE, fig.cap="Bakken",  cache=TRUE}

ggplot( ndg.a.co2e %>% subset(date > lubridate::ymd("2009/01/01") &
                     type %in% c(  "flared", "vented.100")),
  aes(date, value  , fill = type)) +
  geom_area(position = position_stack(reverse = T),
            colour = "white",
            size = .2) +
  scale_fill_manual(values = c("grey30", "firebrick1", "green4")) +
  #scale_y_continuous(label =  scales::percent_format()) +
  theme(   legend.position = c(.2, .8),
    legend.direction = "vertical",
    legend.background = element_rect(fill = mmt::add.alpha("white", .6), size=0),
    legend.title =  element_blank()
  ) +
  labs(
    title =  "North Dakota flaring/venting @100 year CH4 GWP",
    caption = paste0(ndg.i$link, "\n* assumed vented"),
    #subtitle = "annualised production",
    y = "CO2-e - million tonnes per year",
    x = NULL
  ) +
  coord_cartesian(expand = c(0, 0))
```


```{r fig-bakken-20, echo=FALSE, fig.cap="Bakken",  cache=TRUE}


ggplot( ndg.a.co2e %>% subset(date > lubridate::ymd("2009/01/01") &
  type %in% c(  "flared", "vented.20")),
  aes(date, value  , fill = type)) +
  geom_area(position = position_stack(reverse = T),
            colour = "white",
            size = .2) +
  scale_fill_manual(values = c("grey30", "firebrick1", "green4")) +
  #scale_y_continuous(label =  scales::percent_format()) +
  theme(   legend.position = c(.2, .8),
           legend.direction = "vertical",
           legend.background = element_rect(fill = mmt::add.alpha("white", .6), size=0),
           legend.title =  element_blank()
  ) +
  labs(
    title =  "North Dakota flaring/venting @20 year CH4 GWP",
    caption = paste0(ndg.i$link, "\n* assumed vented"),
    #subtitle = "annualised production",
    y = "CO2-e - million tonnes per year",
    x = NULL
  ) +
  coord_cartesian(expand = c(0, 0))
```